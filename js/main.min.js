"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{}).catch(e=>console.log(e));const regexScript=new RegExp(/<script.*src.*=.*("|')(?!\w*(?:http|www)).*\.js('|").*<\/script>/,"gi"),regexScriptSrc=new RegExp(/(?<=src.*=.*('|"))(.*)(?=('|"))/,"gi"),regexLink=new RegExp(/<link.*href.*=.*("|')(?!\w*(?:http|www)).*\.css('|")[^>]*>/,"gi"),regexLinkHref=new RegExp(/(?<=href.*=.*('|"))(.*)(?=('|"))/,"gi"),regexDir=new RegExp(/^(\.|\/)\/?/g);let iframe=document.querySelector("iframe");const buildIframeHtml=e=>{let t=files.filter(t=>t.id==e)[0];if("html"!=t.type)return void console.log(t.name+" is not a valid HTML file");let l=injectCssJs(e,t.contents);iframe.setAttribute("srcdoc",l)},injectCssJs=(e,t)=>(t.match(regexScript).forEach(l=>{let n=l.match(regexScriptSrc)[0],r=getContents(n,e);if(r)t=t.replace(l,`<script>${r}<\/script>`);else{let e=l.replace("src","src-not-found");t=t.replace(l,e)}}),t.match(regexLink).forEach(l=>{let n=l.match(regexLinkHref)[0],r=getContents(n,e);if(r)t=t.replace(l,`<style>${r}</style>`);else{let e=l.replace("href","href-not-found");t=t.replace(l,e)}}),t),getContents=(e,t)=>{let l=files.filter(e=>e.id==t)[0],n=e.match(/^(\.\/|\/)/g);null!=n&&(e=e.replace(n[0],""));let r=null,o=l.path.replace(l.name,"");if(o.length>0&&(r=o.split("/"),r.pop(),r.reverse()),null!=r){let t=(e.match(/\.\./g)||[]).length;for(e=e.replace(/\.\.\//g,""),i=0;i<t&&r.length>0;i++)r.pop();r.length>0&&(e=`${r.join("/")}/${e}`)}let s=files.filter(t=>t.path==e);return s.length?s[0].contents:null};monaco.editor.defineTheme("synth",{base:"vs-dark",inherit:!0,rules:[{token:"",background:"262335"},{token:"comment",foreground:"848BBD",fontStyle:"italic"},{token:"number",foreground:"2EE2FA"},{token:"type",foreground:"FE4450"},{token:"regexp",foreground:"F97E72"},{token:"keyword",foreground:"FEDE5D"},{token:"delimiter",foreground:"BBBBBB"},{token:"delimiter.html",foreground:"36F9F6",fontStyle:"bold"},{token:"identifier",foreground:"2EE2FA"},{token:"string",foreground:"FF8B39"},{token:"tag",foreground:"72F1B8"},{token:"metatag.html",foreground:"72F1B8"},{token:"metatag.content.html",foreground:"FEDE5D",fontStyle:"bold"},{token:"attribute.name",foreground:"FEDE5D",fontStyle:"bold"},{token:"attribute.value",foreground:"FF8B39"}],colors:{"editor.background":"#272234","editor.foreground":"#ffffff"}});const allowedFileTypes=["html","css","js","scss"];let files=[{id:"file_0",name:"index.html",path:"index.html",type:"html",contents:'<!DOCTYPE html>\n<html>\n<head>\n\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t<meta http-equiv="X-UA-Compatible" content="IE=edge" />\n\t<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />\n\t<link rel="stylesheet" href="/css/style.css">\n</head>\n<body>\n\t<h1>Hello</h1>\n\t<script src="./js/main.js"><\/script>\n</body>\n</html>'},{id:"file_1",name:"style.scss",path:"css/style.scss",type:"scss",contents:"* { box-sizing: border-box; }"},{id:"file_2",name:"main.js",path:"js/main.js",type:"js",contents:"console.log('hello world')"},{id:"file_3",name:"js",path:"js",type:"folder",files:[]},{id:"file_4",name:"css",path:"css",type:"folder",files:[]},{id:"file_6",name:"fonts",path:"css/fonts",type:"folder",files:[]},{id:"file_7",name:"icons.css",path:"css/fonts/icons.css",type:"css",contents:".if { font-family: 'IconFont'; }"}],renderFileTree=()=>{let e=[];buildTree("",files,e),console.log(e);let t=document.querySelector('[data-type="files"]');if(e.length>0){let l=document.createElement("ul");buildTreeHTML(l,e),t.appendChild(l)}else t.innerHTML="<button>Add a new file.</button>"},buildTreeHTML=(e,t)=>{t.forEach(t=>{let l=t.type,n=document.createElement("li");n.classList.add(l),"folder"!=l&&n.classList.add("file"),"folder"==l&&n.classList.add("expanded");let r=document.createElement("span");if(r.innerHTML=t.name,r.id=t.id,n.appendChild(r),"folder"==l){let e=document.createElement("ul");buildTreeHTML(e,t.files),n.appendChild(e),r.addEventListener("click",()=>{r.closest("li.folder").classList.contains("expanded")?r.closest("li.folder").classList.remove("expanded"):r.closest("li.folder").classList.add("expanded")})}else r.addEventListener("click",()=>{let e=files.filter(e=>e.path==t.path)[0];if(!tabList.includes(t=>t.path==e.path)){tabList.forEach(e=>e.active=!1);let t={...e,active:!0};tabList.push(t)}});e.appendChild(n)})},sortAlphabetically=(e,t)=>{e.sort((e,l)=>e[t]<l[t]?-1:e[t]>l[t]?1:0)},buildTree=(e,t,l)=>{let n=t.filter(e=>"folder"==e.type).filter(t=>{let l=t.path.replace(e,""),n=l.match(/^(\.\/|\/)/g);return null!=n&&(l=l.replace(n[0],"")),t.name==l});sortAlphabetically(n,"name"),l.push(...n),l.forEach(e=>{let l=t.filter(t=>0==t.path.indexOf(e.path+"/"));l.length>0&&buildTree(e.path,l,e.files)});let r=t.filter(e=>"folder"!=e.type).filter(t=>{let l=t.path.replace(e,""),n=l.match(/^(\.\/|\/)/g);return null!=n&&(l=l.replace(n[0],"")),t.name==l});sortAlphabetically(r,"name"),l.push(...r)};renderFileTree();let tabList=[],options={wordWrap:"on",fontFamily:"Cascadia Code, Consolas, Courier New, monospace"};